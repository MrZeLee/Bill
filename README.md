# Bill - AI-Powered Question Answering Bot for Telegram

Bill is a Telegram bot that uses Google Cloud Vision and OpenAI's GPT models to
answer questions from images. It's designed to process images of quizzes, tests,
or other text-based questions and provide answers using AI.

## Features

- **Image-Based Question Answering:** Takes images as input, extracts text using
  Google Cloud Vision, and formulates answers using OpenAI's GPT models.
- **Contextual Understanding:** Uses the extracted text to understand the
  context of the question.
- **RapidAPI Integration:** Leverages the DuckDuckGo search API via RapidAPI to
  provide additional context and information to the bot.
- **Telegram Integration:** Designed specifically to function as a Telegram bot.
- **Asynchronous Operations:** Uses `asyncio` for efficient and non-blocking
  operations.
- **Logging:** Comprehensive logging for debugging and monitoring.
- **Customizable Prompting:** Allows adding additional context or instructions
  via the `/add` command that influences the bot's responses. Removes them via
  `/rem` command.
- **User Filtering:** Restricts bot usage to specific Telegram users via user
  ID.

## Prerequisites

Before you begin, ensure you have the following:

- **Docker:** [Install Docker](https://docs.docker.com/get-docker/)
- **Environment Variables:** Set up the necessary environment variables. See
  `.env.example` for the required variables and their descriptions.
- **Google Cloud Service Account:** A Google Cloud service account with Vision
  API enabled. Download the service account key file (`service-account.json`).

## Installation

1.  **Clone the repository:**

    ```bash
    git clone <repository_url>
    cd Bill
    ```

2.  **Configure environment variables:**

    - Create a `.env` file in the root directory based on the `.env.example`
      file.
    - Populate the `.env` file with your API keys and other configuration
      values.

    ```bash
    cp .env.example .env
    nano .env  # or your preferred text editor
    ```

3.  **Build the Docker image:**

    ```bash
    docker build -t bill .
    ```

## Usage

1.  **Run the Docker container:**

    ```bash
    docker run -d \
      -v /path/to/service-account.json:/app/service-account.json \
      -v /path/to/.env:/app/.env \
      bill
    ```

    - Replace `/path/to/service-account.json` with the actual path to your
      Google Cloud service account key file.
    - Replace `/path/to/.env` with the actual path to your `.env` file.
    - The `-d` flag runs the container in detached mode (in the background).

2.  **Interact with the bot on Telegram:**

    - Start a conversation with your Telegram bot.
    - Use the `/start` command to initiate the bot.
    - Send an image of a question or text to the bot.
    - The bot will process the image and respond with an answer.

## Bot Commands

- `/start`: Starts the bot and displays a welcome message.
- `/add <text>`: Adds the specified text to the end of the prompt sent to
  OpenAI. This can be used to give the bot additional context or instructions.
  For example: `/add Answer like a tutor.`
- `/rem`: Removes the appended text added via `/add`. Resets the bot to its
  default prompting.

## Environment Variables

The following environment variables are required:

- `BOT_API_TOKEN`: The API token for your Telegram bot.
- `OPENAI_API_KEY`: Your OpenAI API key.
- `OPENAI_CHAT_MODEL`: The OpenAI chat model to use (e.g., `gpt-3.5-turbo`).
- `SERVICE_ACCOUNT_FILE`: The path to your Google Cloud service account key file
  (e.g., `service-account.json`).
- `RAPID_API_KEY`: Your RapidAPI key for accessing the DuckDuckGo search API.

## Logging

The application logs are written to the `app.log` file. This file contains
information about:

- Google Cloud Vision text detection results.
- OpenAI API requests and responses.
- RapidAPI (DuckDuckGo) search queries and results.
- Any errors or exceptions that occur during processing.

## Architecture

1.  **Telegram Bot:** The bot listens for incoming messages containing images.
2.  **Image Processing:** When an image is received, it is downloaded and sent
    to Google Cloud Vision API for text extraction.
3.  **Text Analysis & Contextualization:** The extracted text is analyzed to
    understand the context of the question. RapidAPI is used to fetch related
    information from the web, if applicable.
4.  **Question Answering:** The extracted text and contextual information are
    sent to OpenAI's GPT model to generate an answer.
5.  **Response:** The answer generated by the GPT model is sent back to the user
    via Telegram.

## Future Enhancements

- **Improved Accuracy:** Fine-tuning the GPT model and improving text extraction
  accuracy.
- **More Contextual Awareness:** Integrating with more knowledge sources to
  improve contextual understanding.
- **Support for different question types:** Adding the ability to handle
  different types of questions, such as multiple-choice, true/false, etc.
- **UI Enhancements:** Adding interactive elements to the Telegram bot.
